---
title: 关于
date: 2023-07-20 06:25
uuid: 465
status: publish
tags: 内存泄漏
categories: 编程
---

# 内存泄露定义及危害

内存泄漏是指: 在程序中存在一些已经不再使用的对象，但由于某些原因没有被正确释放，导致这些对象占据了内存空间，无法被垃圾回收器回收，从而导致内存的持续增加，最终可能导致程序的性能下降或者崩溃。

由于内存是有限的，内存泄漏会导致程序的内存消耗不断增加，最终可能导致程序崩溃(内存不够用了, OOM:OutOfMemory)或者性能下降(swap内存读写速率低)。

> 栈内存会自动释放，导致泄露的一般是指动态分配的堆内存, 适用于所有(堆栈内存模型)的语言

# JVM 中的内存泄露

> 以下场景适用于所有基于 JVM 的语言: 如 java, kotlin, groovy 等

## 1. 长生命周期的对象持有短生命周期对象的引用

1. 最严重的是: 全局(整个应用运行期)生命周期的对象持有短生命周期的对象

而拥有全局生命周期地场景: 静态变量, 应用的Application Context

与静态变量相关的常见场景： 单例，静态集合, 静态内部类

2. 其次短生命周期对象拥有长生命周期对象的引用

一个典型的场景： 内部类持有外部类的引用


## 2. 系统资源未关闭

一般是IO资源: socket, 文件读写 

# android 中常见泄露点

context 泄露, 能使用ApplicationContext 则使用ApplicationContext, 否则注意，Activity 或 Fragment 的释放

# 内存泄露常见的分析工具

# 思考

内存泄露是编码中需要时刻关注的点，养成良好的习惯能减少后期的维护成本，否则随着债务的积累，后期优化的代价是不菲的。

在Android 中，关注生命周期，各种Scope的抽象，是针对内存泄露的编码习惯

Kotlin 中的 文件变量（不写在类中的变量）

### 能否在开发中全部使用静态变量？

小应用不迭代的话也不是不可以，复杂且不断迭代的应用，显然是不行的。
